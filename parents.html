<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>ููุณุงุช ูููู ุงูุฃูุฑ</title>
  <link rel="stylesheet" href="style.css">
  <style>
    .small-btn { padding:5px 10px; border-radius:5px; cursor:pointer; margin-left:10px; }
    #editParentsForm { display:none; margin-top:10px; }
  </style>
</head>
<body>
<header>
  <img src="assets/logo2.png" alt="Left Logo" class="logo-left">
  <img src="assets/logo1.png" alt="Right Logo" class="logo-right">
  <h1>๐จโ๐ฉโ๐งโ๐ฆ ููุณุงุช ูููู ุงูุฃูุฑ</h1>
</header>

<nav>
  <a href="index.html">ุงูุฑุฆูุณูุฉ</a>
  <a href="talents.html">ุงูููุงูุจ</a>
  <a href="rules.html">ููุงููู ุงููุงุฆุญุฉ</a>
  <a href="library.html">ุงูููุชุจุฉ ุงูุฅููุชุฑูููุฉ</a>
  <a href="achievements.html">ุฅูุฌุงุฒุงุช ุงููุฏุฑุณุฉ</a>
</nav>

<section id="parents">
  <h2 style="display:flex; justify-content:space-between; align-items:center;">
    ุฏูุฑ ุฃูููุงุก ุงูุฃููุฑ ูู ุชุญููู ุงูุงูุถุจุงุท ุงููุฏุฑุณู
    <button id="editParentsBtn" class="small-btn">โ๏ธ ุชุนุฏูู ุงููุญุชูู</button>
  </h2>

  <div class="parents-steps" id="parentsContent"></div>

  <!-- Edit form -->
  <div id="editParentsForm">
    <textarea id="parentsTextarea" rows="6" style="width:100%;"></textarea><br>
    <button id="saveParentsBtn">๐พ ุญูุธ ุงูุชุนุฏููุงุช</button>
  </div>
</section>

<footer>
  <p>ยฉ 2025 ุจูุงุจุฉ ุงูุฅุจุฏุงุน</p>
</footer>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
  import { getAnalytics } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-analytics.js";
  import { getFirestore, collection, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyDtZ20xX1ly8XnvvN4Q-LvP_YWXfQs3HlU",
    authDomain: "alebdaa-e25be.firebaseapp.com",
    projectId: "alebdaa-e25be",
    storageBucket: "alebdaa-e25be.appspot.com",
    messagingSenderId: "444943642971",
    appId: "1:444943642971:web:fc1ce77de0a9c53d25ea7e",
    measurementId: "G-2E6PLZ7LHJ"
  };

  const app = initializeApp(firebaseConfig);
  getAnalytics(app);
  const db = getFirestore(app);

  const ADMIN_PASS = "Admin_2002";
  const parentsContent = document.getElementById("parentsContent");
  const editBtn = document.getElementById("editParentsBtn");
  const editForm = document.getElementById("editParentsForm");
  const textarea = document.getElementById("parentsTextarea");

  let editMode = false;

  // Render content in real-time
  const parentsDoc = doc(db, "parents", "steps");
  onSnapshot(parentsDoc, docSnap => {
    if(docSnap.exists()) {
      const data = docSnap.data();
      parentsContent.innerHTML = "";
      data.steps.forEach(step => {
        const div = document.createElement("div");
        div.className = `step ${step.color}`;
        div.innerHTML = `<span>${step.icon}</span><p>${step.text}</p>`;
        parentsContent.appendChild(div);
      });

      // Load for edit form
      if(editMode) {
        textarea.value = data.steps.map(s => `${s.icon} ${s.text}`).join("\n");
      }
    } else {
      // Initial content if not exists
      const defaultSteps = [
        {icon:"๐ซ", text:"ุชุญููุฒ ุงูุฃุจูุงุก ุนูู ุงูุฐูุงุจ ุฅูู ุงููุฏุฑุณุฉ", color:"blue"},
        {icon:"๐", text:"ุฅุนูุงู ุงูุฃุจูุงุก ุจุฃูููุฉ ุงูุชุนููู", color:"teal"},
        {icon:"โฝ", text:"ุชุดุฌูุน ุงูุฃุจูุงุก ุนูู ุงูุงุดุชุฑุงู ูู ุงูุฃูุดุทุฉ ุงููุฎุชููุฉ", color:"green"},
        {icon:"๐ฏ", text:"ูุณุงุนุฏุฉ ุงูุฃุจูุงุก ุนูู ุชุญุฏูุฏ ุฃูุฏุงููู ูู ุงูุญูุงุฉ", color:"yellow"}
      ];
      setDoc(parentsDoc, { steps: defaultSteps });
    }
  });

  editBtn.addEventListener("click", () => {
    const pass = prompt("ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ููุชุนุฏูู:");
    if(pass !== ADMIN_PASS) return alert("ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ โ");
    editMode = true;
    editForm.style.display = "block";
  });

  document.getElementById("saveParentsBtn").addEventListener("click", async () => {
    const lines = textarea.value.split("\n").map(line => {
      const match = line.match(/^(\S+)\s+(.*)$/);
      if(match) return { icon: match[1], text: match[2], color: "blue" }; // default color
      return null;
    }).filter(l => l !== null);

    await setDoc(parentsDoc, { steps: lines });
    alert("โ ุชู ุญูุธ ุงูุชุนุฏููุงุช!");
  });

</script>
</body>
</html>
